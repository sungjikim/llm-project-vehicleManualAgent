<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°¨ëŸ‰ ë§¤ë‰´ì–¼ RAG ì‹œìŠ¤í…œ - Node êµ¬ì„± ë° íë¦„ë„</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        h2 {
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        .diagram {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .description {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .feature-list {
            background-color: #f0f8f0;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .feature-list ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .feature-list li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš— ì°¨ëŸ‰ ë§¤ë‰´ì–¼ RAG ì‹œìŠ¤í…œ - Node êµ¬ì„± ë° íë¦„ë„</h1>
        
        <div class="description">
            <h3>ğŸ“‹ ì‹œìŠ¤í…œ ê°œìš”</h3>
            <p>LangChain/LangGraph ê¸°ë°˜ì˜ ëª¨ë“ˆí™”ëœ ì°¨ëŸ‰ ë§¤ë‰´ì–¼ RAG ì—ì´ì „íŠ¸ë¡œ, SubGraph ì•„í‚¤í…ì²˜ë¥¼ í†µí•´ ì‘ê¸‰ ìƒí™© ê°ì§€, í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰, ì£¼í–‰ ì¤‘ ìµœì í™” ë“±ì˜ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
        </div>

        <h2>1. ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h2>
        <div class="diagram">
            <div class="mermaid">
graph TD
    A[ì‚¬ìš©ì ì…ë ¥] --> B{ì¸í„°í˜ì´ìŠ¤ ì„ íƒ}
    B -->|í„°ë¯¸ë„| C[Terminal Interface]
    B -->|ì›¹| D[Gradio Interface]
    
    C --> E[VehicleManualAgentSubGraph]
    D --> E
    
    E --> F[LangGraph Workflow]
    
    F --> G[Emergency Detection Node]
    G --> H[Search Pipeline Node]
    H --> I[Answer Generation Node]
    I --> J[Driving Context Node]
    J --> K[ìµœì¢… ë‹µë³€]
    
    K --> L{ì¸í„°í˜ì´ìŠ¤ íƒ€ì…}
    L -->|í„°ë¯¸ë„| M[ì½˜ì†” ì¶œë ¥]
    L -->|ì›¹| N[ì›¹ UI í‘œì‹œ]
            </div>
        </div>

        <h2>2. SubGraph ìƒì„¸ êµ¬ì¡°</h2>
        <div class="diagram">
            <div class="mermaid">
graph TD
    subgraph "Main Agent (VehicleManualAgentSubGraph)"
        A[ì‚¬ìš©ì ì¿¼ë¦¬] --> B[Emergency Detection Wrapper]
        B --> C[Search Pipeline Wrapper]
        C --> D[Answer Generation Wrapper]
        D --> E[Driving Context Wrapper]
        E --> F[ìµœì¢… ë‹µë³€]
    end
    
    subgraph "Emergency Detection SubGraph"
        B1[Emergency Classifier]
        B2[Priority Level Analysis]
        B3[Search Strategy Selection]
        B1 --> B2 --> B3
    end
    
    subgraph "Search Pipeline SubGraph"
        C1[Query Analyzer]
        C2[Search Method Selector]
        C3[Document Retrieval]
        C4[Re-ranking/Compression]
        C1 --> C2 --> C3 --> C4
    end
    
    subgraph "Answer Generation SubGraph"
        D1[Context Builder]
        D2[Answer Generator]
        D3[Answer Evaluator]
        D1 --> D2 --> D3
    end
    
    subgraph "Driving Context SubGraph"
        E1[Driving Context Detector]
        E2[Answer Compressor]
        E3[Final Answer Formatter]
        E1 --> E2 --> E3
    end
    
    B --> B1
    C --> C1
    D --> D1
    E --> E1
            </div>
        </div>

        <h2>3. ê²€ìƒ‰ íŒŒì´í”„ë¼ì¸ ìƒì„¸ íë¦„</h2>
        <div class="diagram">
            <div class="mermaid">
graph TD
    A[ì‚¬ìš©ì ì¿¼ë¦¬] --> B{ì‘ê¸‰ ìƒí™©?}
    
    B -->|Yes| C[ì‘ê¸‰ ëª¨ë“œ]
    B -->|No| D[ì¼ë°˜ ëª¨ë“œ]
    
    C --> E[Hybrid Keyword Search]
    D --> F[Query Analysis]
    
    F --> G{ê²€ìƒ‰ ì „ëµ ì„ íƒ}
    G -->|General| H[Hybrid Semantic]
    G -->|Specific| I[Vector Only]
    G -->|Keyword| J[BM25 Only]
    G -->|Multi-query| K[Multi Query]
    
    E --> L[Document Retrieval]
    H --> L
    I --> L
    J --> L
    K --> L
    
    L --> M{ì¬ìˆœìœ„í™”/ì••ì¶•?}
    M -->|Yes| N[Cross-Encoder Reranking]
    M -->|No| O[Raw Results]
    
    N --> P[Contextual Compression]
    O --> Q[Search Results]
    P --> Q
            </div>
        </div>

        <h2>4. ì½œë°± ì‹œìŠ¤í…œ</h2>
        <div class="diagram">
            <div class="mermaid">
graph TD
    A[ì‚¬ìš©ì ì¿¼ë¦¬] --> B[Performance Monitoring Handler]
    A --> C[Real-time Notification Handler]
    A --> D[Alert Handler]
    
    B --> E[ì‹¤í–‰ ì‹œê°„ ì¸¡ì •]
    B --> F[í† í° ì‚¬ìš©ëŸ‰ ì¶”ì ]
    B --> G[ì„±ëŠ¥ í†µê³„ ìˆ˜ì§‘]
    
    C --> H[ì§„í–‰ ìƒí™© í‘œì‹œ]
    C --> I[ì‹¤ì‹œê°„ ì•Œë¦¼]
    
    D --> J[í† í° ì œí•œ ëª¨ë‹ˆí„°ë§]
    D --> K[ë¹„ìš© ì œí•œ ëª¨ë‹ˆí„°ë§]
    D --> L[ì•Œë¦¼ ë°œì†¡]
    
    E --> M[ì„±ëŠ¥ ë¦¬í¬íŠ¸]
    F --> M
    G --> M
    
    H --> N[ì‚¬ìš©ì í”¼ë“œë°±]
    I --> N
    
    J --> O[ì‚¬ìš©ëŸ‰ ê²½ê³ ]
    K --> O
    L --> O
            </div>
        </div>

        <h2>5. ì¸í„°í˜ì´ìŠ¤ êµ¬ì¡°</h2>
        <div class="diagram">
            <div class="mermaid">
graph TD
    subgraph "Terminal Interface"
        A1[run_terminal_interface]
        A2[ì‚¬ìš©ì ì…ë ¥ ëŒ€ê¸°]
        A3[ì—ì´ì „íŠ¸ ì¿¼ë¦¬ ì‹¤í–‰]
        A4[ê²°ê³¼ ì¶œë ¥]
        A5[í†µê³„ í‘œì‹œ]
        A1 --> A2 --> A3 --> A4 --> A5
    end
    
    subgraph "Gradio Interface"
        B1[GradioVehicleChatbot]
        B2[ì›¹ UI ìƒì„±]
        B3[ì±„íŒ… ì¸í„°í˜ì´ìŠ¤]
        B4[ì‚¬ì´ë“œë°” ì •ë³´]
        B5[ì˜ˆì‹œ ì§ˆë¬¸ ë²„íŠ¼]
        B6[í†µê³„ í‘œì‹œ]
        B1 --> B2
        B2 --> B3
        B2 --> B4
        B2 --> B5
        B2 --> B6
    end
    
    A3 --> C[VehicleManualAgentSubGraph]
    B3 --> C
            </div>
        </div>

        <h2>6. ë°ì´í„° íë¦„</h2>
        <div class="diagram">
            <div class="mermaid">
graph LR
    A[PDF ë¬¸ì„œ] --> B[Document Loader]
    B --> C[Vector Store]
    B --> D[BM25 Index]
    
    C --> E[Semantic Search]
    D --> F[Keyword Search]
    
    E --> G[Hybrid Retriever]
    F --> G
    
    G --> H[Search Results]
    H --> I[Re-ranking]
    I --> J[Context Compression]
    J --> K[Answer Generation]
    K --> L[Driving Context Processing]
    L --> M[Final Answer]
            </div>
        </div>

        <div class="feature-list">
            <h3>ğŸ”§ ì£¼ìš” íŠ¹ì§•</h3>
            <ul>
                <li><strong>SubGraph ì•„í‚¤í…ì²˜</strong>: ê° ê¸°ëŠ¥ì„ ë…ë¦½ì ì¸ SubGraphë¡œ ëª¨ë“ˆí™”</li>
                <li><strong>ì‘ê¸‰ ìƒí™© ê°ì§€</strong>: ìë™ìœ¼ë¡œ ì‘ê¸‰ ìƒí™©ì„ ê°ì§€í•˜ê³  ìš°ì„ ìˆœìœ„ ì²˜ë¦¬</li>
                <li><strong>í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰</strong>: ë²¡í„° ê²€ìƒ‰ê³¼ í‚¤ì›Œë“œ ê²€ìƒ‰ì„ ê²°í•©</li>
                <li><strong>ì£¼í–‰ ì¤‘ ìµœì í™”</strong>: ìš´ì „ ì¤‘ ìƒí™©ì„ ê°ì§€í•˜ì—¬ ë‹µë³€ì„ ì••ì¶•</li>
                <li><strong>ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</strong>: ì„±ëŠ¥ ë° ì‚¬ìš©ëŸ‰ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ì </li>
                <li><strong>ë‹¤ì¤‘ ì¸í„°í˜ì´ìŠ¤</strong>: í„°ë¯¸ë„ê³¼ ì›¹ ì¸í„°í˜ì´ìŠ¤ ëª¨ë‘ ì§€ì›</li>
            </ul>
        </div>

        <div class="description">
            <h3>ğŸ“ ì‚¬ìš©ë²•</h3>
            <p><strong>í„°ë¯¸ë„ ëª¨ë“œ:</strong> <code>python main.py</code></p>
            <p><strong>ì›¹ ëª¨ë“œ:</strong> <code>python main.py --gradio</code></p>
            <p><strong>í¬íŠ¸ ë³€ê²½:</strong> <code>python main.py --gradio --port 8080</code></p>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            }
        });
    </script>
</body>
</html>
